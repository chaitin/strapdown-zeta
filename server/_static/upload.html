<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Upload file</title>
    <style>
        iframe {
            display: none;
            width: 0;
            height: 0;
            tab-index: -1;
        }
    </style>
    <link rel="stylesheet" href="{{.Host}}/themes/cerulean.min.css">
</head>
<body class="row">
<div class="col-lg-6 col-lg-offset-3">
    <h1>Upload file page</h1>

    <form id="upload_form" name="upload_form" action="/upload/" method="post"
          enctype="multipart/form-data">

        <div class="form-group">
            <label>File path</label>
            <input name="upload_path" class="form-control" id="upload_path" type="text" autocomplete="off">
        </div>
        <div class="form-group">
            <label>Choose file</label>
            <input name="body" id="file_body" type="file" onchange="updateUploadPath()">
        </div>
        <div class="form-group">
            <button id="upload_btn" class="btn btn-primary" onclick="upload()">upload</button>
        </div>
        <iframe id="upload_iframe" name="upload_iframe" src="/upload/">
        </iframe>


    </form>
    <script>
        function getFileName() {
            return document.getElementById("file_body").value.split(/(\\|\/)/g).pop();
        }

        function updateUploadPath() {
            var uploadPath = "/upload/" + getFileName();
            document.getElementById("upload_path").value = uploadPath;
            return uploadPath;
        }

        function getUploadPath() {
            return document.getElementById("upload_path").value;
        }

        function upload() {
            var uploadPath = getUploadPath();
            if (!uploadPath) {
                uploadPath = updateUploadPath();
            }

            document.getElementById("upload_form").action = uploadPath;
            document.getElementById("upload_iframe").src = uploadPath;

            document.getElementById("upload_form").target = "upload_iframe";
            document.getElementById("upload_form").submit();
            alert("Upload completed");
        }
    </script>
</div>
</body>
</html>